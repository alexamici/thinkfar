<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
    <title>think-far</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" charset="utf-8" href="http://cdn.sencha.io/ext-4.0.2a/resources/css/ext-all.css" />
    <script type="text/javascript" charset="utf-8" src="http://cdn.sencha.io/ext-4.0.2a/ext-all.js"></script>
    <script type="text/javascript">
Ext.require([
    'Ext.data.*'
]);

Ext.define('Book', {
    extend: 'Ext.data.Model',
    fields: [
        {name: 'uid', type: 'string'},
        {name: 'name',  type: 'string'},
        {name: 'accounting_universe_uid', type: 'string'},
        {name: 'inventory_count',  type: 'int'}
    ]
});

Ext.onReady(function() {
    Ext.QuickTips.init();

    var store = Ext.create('Ext.data.Store', {
        model: 'Book',
        proxy: {
            type: 'ajax',
            url : '/${user.uid}/b.json',
        },
        autoLoad: true
    });

    var grid = Ext.create('Ext.grid.Panel', {
        title: 'Books',
        store: store,
        columns: [
            {header: 'Uid', dataIndex: 'uid'},
            {header: 'Name', dataIndex: 'name', flex: 1},
            {header: 'Universe', dataIndex: 'accounting_universe_uid'},
            {header: 'Inventory', dataIndex: 'inventory_count', flex: 1}
        ],
        height: 200,
        width: 400,
        renderTo: 'thinkfar-table-grid'
    });
})
    </script>
</head>
<body>
    <div id="content">
        <h2 class="title">User: ${user.principal.nickname()}</h2>
        <div id="thinkfar-table-query"></div>
        <br />
        <div id="thinkfar-table-grid"></div>
    </div>
</body>
</html>