<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    metal:use-macro="main.macros['main']">
<head>
	<metal:head metal:fill-slot="head">
    	<title>${title} - thinkfar</title>
        <script type="text/javascript">
Ext.require([
    'Ext.data.*'
]);

Ext.define('Book', {
    extend: 'Ext.data.Model',
    fields: [
        {name: 'uid', type: 'string'},
        {name: 'name',  type: 'string'},
        {name: 'accounting_universe_uid', type: 'string'},
        {name: 'inventory_count',  type: 'int'}
    ]
});

Ext.onReady(function() {
    Ext.QuickTips.init();

    var store = Ext.create('Ext.data.Store', {
        model: 'Book',
        proxy: {
            type: 'ajax',
            url : '/${user.uid}/b/${book.uid}/i.json',
        },
        autoLoad: true
    });

    var grid = Ext.create('Ext.grid.Panel', {
        store: store,
        columns: [
            {header: 'Uid', dataIndex: 'uid'},
            {header: 'Name', dataIndex: 'name', flex: 1},
            {header: 'Universe', dataIndex: 'accounting_universe_uid'},
            {header: 'Inventory', dataIndex: 'inventory_count', flex: 1}
        ],
        height: 200,
        width: 400,
        renderTo: 'thinkfar-table-grid'
    });
})
        </script>
    </metal:head>
</head>
<body>
	<metal:content metal:fill-slot="content">
        <div id="content">
            <h2 class="title">Book: ${book.name}</h2>
            <div id="thinkfar-table-query"></div>
            <br />
            <div id="thinkfar-table-grid"></div>
        </div>
    </metal:content>
</body>
</html>