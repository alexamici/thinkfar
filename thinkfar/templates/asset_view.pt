<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    metal:use-macro="main.macros['main']">
  <div metal:fill-slot="content">
    <div id="content">
      <div class="post">
        <h1 class="title">${title}</h1>
        <h3>asset trade history as of ${date.isoformat()}</h3>
        <table>
          <thead>
            <tr>
              <th>Trade date</th>
              <th>Amount</th>
              <th>Buyer Price</th>
              <th>Seller Value</th>
              <th>Spread</th>
              <th>Balance</th>
            </tr>
          </thead>
          <tbody align="right">
            <tr tal:repeat="trade asset.trades">
              <td>
                <a href="${request.application_url}/trade/${trade.id}">${trade.date}</a>
              </td>
              <td>${trade.amount}</td>
              <td>${trade.buyer_price}</td>
              <td>${trade.seller_value}</td>
              <td>${trade.buyer_price-trade.seller_value}</td>
              <td>${asset.balance(trade.date)}</td>
            </tr>
          </tbody>
          <tfoot align="right">
            <tr>
              <td>Total</td>
              <td></td>
              <td></td>
              <td></td>
              <td>${asset.cumulative_spread(date)}</td>
              <td>${asset.balance(date)}</td>
            </tr>
          </tfoot>
        </table>
        <h3>asset income/expenses history as of ${date.isoformat()}</h3>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Start date</th>
              <th>End date</th>
              <th>Income/Expenses</th>
              <th>Is estimated?</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody align="right">
            <tr tal:repeat="income_expenses asset.yearly_income_expenses">
              <td>
                <a href="${request.application_url}/income_expenses/${income_expenses.id}">${income_expenses.name}</a>
              </td>
              <td>${income_expenses.start_date()}</td>
              <td>${income_expenses.end_date}</td>
              <td>${income_expenses.yearly_income_expenses}</td>
              <td>${income_expenses.is_estimated}</td>
              <td>${income_expenses.description}</td>
            </tr>
          </tbody>
          <tfoot align="right">
            <tr>
              <td>Total</td>
              <td></td>
              <td></td>
              <td>${asset.estimated_yearly_income_expenses(date)}</td>
              <td></td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
</html>
